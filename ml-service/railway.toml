[build]
builder = "DOCKERFILE"
dockerfilePath = "Dockerfile"

[deploy]
startCommand = "uvicorn app.main:app --host 0.0.0.0 --port $PORT"
healthcheckPath = "/health"
healthcheckTimeout = 100
restartPolicyType = "ON_FAILURE"
restartPolicyMaxRetries = 10

# Environment variables (set in Railway dashboard or CLI)
# These are just defaults - override in Railway dashboard
[[deploy.environmentVariables]]
name = "ML_SERVICE_HOST"
value = "0.0.0.0"

[[deploy.environmentVariables]]
name = "LOG_LEVEL"
value = "INFO"

[[deploy.environmentVariables]]
name = "LIGHTFM_EPOCHS"
value = "50"

[[deploy.environmentVariables]]
name = "LIGHTFM_THREADS"
value = "4"

[[deploy.environmentVariables]]
name = "PROPHET_SEASONALITY_MODE"
value = "multiplicative"

[[deploy.environmentVariables]]
name = "CACHE_TTL_HOURS"
value = "24"

[[deploy.environmentVariables]]
name = "MAX_REQUESTS_PER_MINUTE"
value = "60"
